import s from"alpinejs";document.addEventListener("alpine:init",()=>{s.prefix("data-x-"),s.store("cokiban",{id:null,name:"",version:null,days:null,active:!0,date:null,show:!1,details:!1,cache:{},valid:{},initialize(e){const a=this;a.id=e.id,a.name=e.name,a.version=e.version,a.days=e.days,a.active=e.active,Array.isArray(e.cookies)&&e.cookies.forEach(t=>{a.cache[t]=!1}),a.valid=Object.assign({},a.cache),a.pages=e.pages,a.load(),a.active!==!1&&(a.date===null||a.days&&a.date+a.days*864e5<new Date().getTime())&&a.openBanner()},load(){const e=this;let a=localStorage.getItem(e.name);try{a=JSON.parse(a)}catch{a=null}a!==null&&a.version===e.version&&(e.date=a.date,Object.keys(a.cookies).forEach(t=>{e.cache[t]!==void 0&&(e.cache[t]=a.cookies[t])}),e.valid=Object.assign({},e.cache))},save(){const e=this;e.valid=Object.assign({},e.cache),localStorage.setItem(e.name,JSON.stringify({id:e.id,version:e.version,date:new Date().getTime(),cookies:e.valid})),e.closeBanner()},acceptAll(){const e=this;Object.keys(e.cache).forEach(a=>{e.cache[a]=!0}),clearInterval(this.counter),e.save()},saveSettings(){this.save()},switchCookie(e){const a=this,t=e.split(/[A-Z]/)[0];let n=!0;Object.keys(a.cache).forEach(i=>{i!==e&&i.startsWith(e)&&(a.cache[i]=a.cache[e]),i!==t&&i.startsWith(t)&&!a.cache[i]&&(n=!1)}),a.cache[t]=n},openBanner(){const e=this;e.details=!1,e.show=!0},closeBanner(){const e=this;e.show=!1}}),s.bind("cokiban",()=>({"data-x-bind:class"(){return{"cokiban--show":this.show}}})),s.bind("cokibanDetails",()=>({"data-x-on:click"(){this.details=!this.details}})),s.bind("cokibanSwitch",()=>({"data-x-on:change"(e){this.switchCookie(e)}})),s.bind("cokibanSaveSettings",()=>({"data-x-on:click"(){this.saveSettings()}})),s.bind("cokibanAcceptAll",()=>({"data-x-on:click"(){this.acceptAll()}}))}),window.Alpine=s,s.start();
