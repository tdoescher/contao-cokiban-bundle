import a from"alpinejs";document.addEventListener("alpine:init",()=>{a.prefix("data-x-"),a.store("cokiban",{id:null,name:"",version:null,days:null,active:!0,date:null,show:!1,details:!1,cache:{},valid:{},initialize(t){this.id=t.id,this.name=t.name,this.version=t.version,this.days=t.days,this.active=t.active,Array.isArray(t.cookies)&&t.cookies.forEach(i=>{this.cache[i]=!1}),this.valid=Object.assign({},this.cache),this.loadConfig(),this.active!==!1&&(this.date===null||this.days&&this.date+this.days*864e5<new Date().getTime())&&this.openBanner()},loadConfig(){let t=localStorage.getItem(this.name);try{t=JSON.parse(t)}catch{t=null}t!==null&&t.version===this.version&&(this.date=t.date,Object.keys(t.cookies).forEach(i=>{this.cache[i]!==void 0&&(this.cache[i]=t.cookies[i])}),this.valid=Object.assign({},this.cache))},saveConfig(){this.valid=Object.assign({},this.cache),localStorage.setItem(this.name,JSON.stringify({id:this.id,version:this.version,date:new Date().getTime(),cookies:this.valid})),this.closeBanner()},acceptAll(){Object.keys(this.cache).forEach(t=>{this.cache[t]=!0}),this.saveConfig()},showDetails(){this.details=!this.details},saveSettings(){this.saveConfig()},switchCookie(t){const i=t.split(/[A-Z]/)[0];let e=!0;this.cache[t]=!this.cache[t],Object.keys(this.cache).forEach(s=>{s!==t&&s.startsWith(i)&&(this.cache[s]=this.cache[t]),s!==i&&s.startsWith(i)&&!this.cache[s]&&(e=!1)}),this.cache[i]=e},openBanner(){this.details=!1,this.show=!0},closeBanner(){this.show=!1},bindCokiban:{"data-x-bind:class"(){return{"cokiban--show":this.show}}},bindDetails:{"data-x-on:click"(){this.showDetails()}},bindSwitch:{"data-x-on:change"(t){this.switchCookie(t.target.dataset.cookie)}},bindSaveSettings:{"data-x-on:click"(){this.saveSettings()}},bindAcceptAll:{"data-x-on:click"(){this.acceptAll()}},bindOpenBanner:{"data-x-on:click.prevent"(){this.$store.cokiban.openBanner()}}})});
