(()=>{document.addEventListener("alpine:init",()=>{Alpine.prefix("data-x-"),Alpine.store("cokiban",{id:null,name:"",version:null,days:null,active:!0,date:null,show:!1,details:!1,labels:{},cache:{},valid:{},googleConsentMode:!1,googleConsentModeDefault:{ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied"},loadConfig(){let e=localStorage.getItem(this.name);try{e=JSON.parse(e)}catch{e=null}e!==null&&this.version===this.version&&(this.date=e.date,Object.keys(e.cookies).forEach(t=>{this.cache[t]!==void 0&&(this.cache[t]=e.cookies[t])}),this.valid=Object.assign({},this.cache)),setTimeout(()=>this.updateGoogleConsentMode(),200)},saveConfig(){this.valid=Object.assign({},this.cache),localStorage.setItem(this.name,JSON.stringify({id:this.id,version:this.version,date:new Date().getTime(),cookies:this.valid})),this.closeBanner(),this.updateGoogleConsentMode()},acceptAll(){Object.keys(this.cache).forEach(e=>{this.cache[e]=!0}),clearInterval(this.counter),this.saveConfig()},saveSettings(){this.saveConfig()},switchCookie(e){let t=e.split(/[A-Z]/)[0],a=!0;this.cache[e]=!this.cache[e],Object.keys(this.cache).forEach(s=>{s!==e&&s.startsWith(e)&&(this.cache[s]=this.cache[e]),s!==t&&s.startsWith(t)&&!this.cache[s]&&(a=!1)}),this.cache[t]=a},openBanner(){this.details=!1,this.show=!0},closeBanner(){this.show=!1},updateGoogleConsentMode(e=!1){let t=this;window.dataLayer=window.dataLayer||[];function a(){window.dataLayer.push(arguments)}if(t.googleConsentMode)if(e){let s={...t.googleConsentModeDefault};Object.keys(t.cache).forEach(i=>{let o=i.match(/[A-Z].*$/);o&&(s[o[0].toLowerCase()+"_storage"]="denied")}),a("consent","default",s)}else{let s={...t.googleConsentModeDefault};Object.keys(t.cache).forEach(i=>{i==="marketing"&&t.cache.marketing&&(s.ad_storage="granted",s.ad_user_data="granted",s.ad_personalization="granted"),i==="trackingAnalytics"&&t.cache.trackingAnalytics&&(s.analytics_storage="granted");let o=i.match(/[A-Z].*$/);o&&(s[o[0].toLowerCase()+"_storage"]=t.cache[i]?"granted":"denied")}),a("consent","update",s),a({event:"cookie_consent_update"})}}}),Alpine.data("cokiban-banner",()=>({get store(){return Alpine.store("cokiban")},showDetails(){return this.store.details},showOverview(){return!this.store.details},bindCokiban:{"data-x-bind:class"(){return{"cokiban--show":this.store.show}},"data-x-init"(){let e=this.$el.dataset.cokibanConfig.split(",");this.store.id=e[0],this.store.name="cokiban_store_"+e[0],this.store.version=e[1],this.store.days=e[2],this.store.active=e[3]==="1",this.store.googleConsentMode=e[4]==="1",this.store.labels.switchTrue=this.$el.dataset.cokibanLabelSwitchTrue,this.store.labels.switchFalse=this.$el.dataset.cokibanLabelSwitchFalse;let t=this.$el.dataset.cokibanCookies.split(",");Array.isArray(t)&&t.forEach(a=>this.store.cache[a]=!1),this.store.updateGoogleConsentMode(!0),this.store.valid=Object.assign({},this.store.cache),this.store.loadConfig(),this.store.active!==!1&&(this.store.date===null||this.store.days&&this.store.date+this.store.days*864e5<new Date().getTime())&&this.store.openBanner()}},bindDetailsButton:{"data-x-on:click.prevent"(){this.store.details=!0},"data-x-show"(){return!this.store.details}},bindBackButton:{"data-x-on:click.prevent"(){this.store.details=!1},"data-x-show"(){return this.store.details}},bindSwitch:{"data-x-on:change"(e){this.store.switchCookie(e.target.dataset.cokibanCookie)},"data-x-bind:checked"(){return this.store.cache[this.$el.dataset.cokibanCookie]}},bindSwitchLabel:{"data-x-text"(){return this.store.cache[this.$el.dataset.cokibanCookie]?this.store.labels.switchTrue:this.store.labels.switchFalse}},bindSaveSettings:{"data-x-on:click"(){this.store.saveSettings()}},bindAcceptAll:{"data-x-on:click"(){this.store.acceptAll()}}})),Alpine.data("cokiban-button",()=>({get store(){return Alpine.store("cokiban")},bind:{"data-x-on:click.prevent"(){this.store.openBanner()}}})),Alpine.data("cokiban-template",()=>({get store(){return Alpine.store("cokiban")},bind:{"data-x-if"(){return this.$el.dataset.cokibanCookies.split(",").find(e=>this.store.valid[e])}}})),Alpine.data("cokiban-replacement",()=>({get store(){return Alpine.store("cokiban")},bind:{"data-x-if"(){return!this.$el.dataset.cokibanCookies.split(",").find(e=>this.store.valid[e])}}}))});})();
